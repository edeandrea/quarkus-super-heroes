name: Test matrix

on:
  workflow_dispatch:

jobs:
  test:
    runs-on: ubuntu-latest
    strategy:
      fail-fast: false
      matrix:
        java:
          - '17'
        project:
          - { name: event-statistics }
          - { name: rest-fights }
          - { name: rest-heroes }
          - { name: rest-villains }
          - { name: rest-narration, openai-type: openai }
          - { name: rest-narration, openai-type: azure-openai }
          - { name: grpc-locations }
          - { name: ui-super-heroes }
        # exclude:
        #   - project: event-statistics
        #     openai-type: openai
        #   - project: event-statistics
        #     openai-type: azure-openai
        #   - project: rest-fights
        #     openai-type: openai
        #   - project: rest-fights
        #     openai-type: azure-openai
        #   - project: rest-heroes
        #     openai-type: openai
        #   - project: rest-heroes
        #     openai-type: azure-openai
        #   - project: rest-villains
        #     openai-type: openai
        #   - project: rest-villains
        #     openai-type: azure-openai
        #   - project: grpc-locations
        #     openai-type: openai
        #   - project: grpc-locations
        #     openai-type: azure-openai
        #   - project: ui-super-heroes
        #     openai-type: openai
        #   - project: ui-super-heroes
        #     openai-type: azure-openai
        #   - project: rest-narration
        #     openai-type: ""
    name: "build-test-${{ matrix.project.name }}-${{ matrix.java }}-${{ matrix.project.openai-type }}"
    steps:
      - uses: actions/checkout@v4

      - name: Show common
        if: matrix.project.openai-type == ''
        run: echo "Running for project = ${{ matrix.project.name }} and java = ${{ matrix.java }}"

      - name: Show specific
        if: matrix.project.openai-type
        run: echo "Project = ${{ matrix.project.name }}, java = ${{ matrix.java }}, openai-type = ${{ matrix.project.openai-type }}"
